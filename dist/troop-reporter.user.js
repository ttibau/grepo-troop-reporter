// ==UserScript==
// @name         [BR] Troop Reporter by tiba
// @namespace    grepolis-ally-reporter
// @version      3.4.2
// @description  Coleta Grepolis -> Sheets (snapshot), 6/6h. LÃª endpoint+version de um Gist (JSON)...
// @match        https://*.grepolis.com/*
// @updateURL    https://raw.githubusercontent.com/<user>/<repo>/main/dist/troop-reporter.user.js
// @downloadURL  https://raw.githubusercontent.com/<user>/<repo>/main/dist/troop-reporter.user.js
// @run-at       document-idle
// @grant        GM_xmlhttpRequest
// @grant        GM_setValue
// @grant        GM_getValue
// @grant        unsafeWindow
// @connect      script.google.com
// @connect      gist.github.com
// @connect      gist.githubusercontent.com
// @connect      raw.githubusercontent.com
// @connect      githubusercontent.com
// ==/UserScript==

(()=>{var Dt=(I,S)=>()=>(S||I((S={exports:{}}).exports,S),S.exports);var qt=Dt(()=>{(function(){"use strict";const I="https://gist.github.com/ttibau/1ceeef7a3a815aeb0cbe3ca0665c6cd5",st={right:12,bottom:72},U={right:12,bottom:12},lt=new Set(["andromeda","christopholus"]),w=3,ct=1500,ut=400,dt=30*1e3;let R=null,y=null,W=null,l=null,h=null,d=null,L=null,C=null,D=null,v=Date.now()+216e5,g=!1,E=!1,q=!1,N=!1,A=0;function $(t){return`last_sent_${t||"unknown"}`}function J(t){return`send_history_${t||"unknown"}`}function V(t){return`alli_name_${t||"unknown"}`}const G="gist_version_local",pt="gist_endpoint_url",Vt="toggle_pos",j="panel_pos",O=(t,e,n)=>Math.min(n,Math.max(e,t)),mt=(t,e)=>{try{const n=GM_getValue(t,null);if(!n)return{...e};const o=JSON.parse(n);return typeof o?.right=="number"&&typeof o?.bottom=="number"?o:{...e}}catch{return{...e}}};function gt(){return new Date().toISOString()}function F(t){return Date.now()-(t||0)}function T(t){return new Promise(e=>setTimeout(e,t))}function P(t){return ct*Math.pow(1.5,t-1)+Math.floor(Math.random()*ut)}function u(t){const e=document.querySelector("#gp-status");e&&(e.textContent=t)}function M(){const t=document.querySelector("#gp-countdown");if(!t)return;const e=Math.max(0,v-Date.now()),n=Math.floor(e/1e3),o=Math.floor(n/3600),i=Math.floor(n%3600/60),r=n%60;t.textContent=`${String(o).padStart(2,"0")}:${String(i).padStart(2,"0")}:${String(r).padStart(2,"0")}`}function X(t,e,n,o=""){const i=J(t);let r=[];try{r=JSON.parse(GM_getValue(i,"[]"))}catch{}r.unshift({ts:new Date().toLocaleString(),success:e,cityCount:n,note:o}),r=r.slice(0,5),GM_setValue(i,JSON.stringify(r)),K(r)}function K(t){const e=document.querySelector("#gp-history");if(e){if(!t||!t.length){e.innerHTML="<em>Sem hist\xF3rico ainda.</em>";return}e.innerHTML=t.map(n=>`<div style="display:flex;justify-content:space-between;gap:8px;">
          <span>${n.success?"\u2705":"\u274C"} ${n.ts}</span>
          <span>${n.cityCount??"-"} cidades</span>
        </div>`).join("")}}function ft(){try{Q(880,120)}catch{}}function yt(){try{Q(220,180)}catch{}}function Q(t=440,e=150){const n=new(window.AudioContext||window.webkitAudioContext),o=n.createOscillator(),i=n.createGain();o.type="sine",o.frequency.value=t,o.connect(i),i.connect(n.destination),o.start(),i.gain.setValueAtTime(.001,n.currentTime),i.gain.exponentialRampToValueAtTime(.2,n.currentTime+.01),i.gain.exponentialRampToValueAtTime(.001,n.currentTime+e/1e3),setTimeout(()=>{o.stop(),n.close()},e+50)}function x(t,e){if(!t)return!1;try{return t.dispatchEvent(new MouseEvent(e,{bubbles:!0,cancelable:!0,view:typeof unsafeWindow<"u"?unsafeWindow:window})),!0}catch{try{return t.dispatchEvent(new MouseEvent(e,{bubbles:!0,cancelable:!0})),!0}catch{try{return t.dispatchEvent(new Event(e,{bubbles:!0,cancelable:!0})),!0}catch{return e==="click"&&typeof t.click=="function"?(t.click(),!0):!1}}}}async function z(t=45e3){const e=".content > ul > li.main_menu_item",n=Date.now();return document.querySelector(e)?!0:new Promise(o=>{const i=new MutationObserver(()=>{document.querySelector(e)&&(i.disconnect(),o(!0))});i.observe(document.body,{childList:!0,subtree:!0});const r=setInterval(()=>{document.querySelector(e)?(clearInterval(r),i.disconnect(),o(!0)):Date.now()-n>t&&(clearInterval(r),i.disconnect(),o(!1))},300)})}function _(){const e=location.host.split(".")[0]||"",n=typeof unsafeWindow<"u"?unsafeWindow:window;let o=n.Game&&n.Game.player_name||"",i=n.Game&&n.Game.alliance_name||"";return o||(o=document.querySelector("#ui_box .player_name, .ui_info .player_name, .player_name")?.textContent?.trim()||document.querySelector(".ui_various .player, .gp_player_name")?.textContent?.trim()||""),i||(i=document.querySelector(".alliance_name, .ui_info .alliance, .gp_alliance_name")?.textContent?.trim()||""),{world:e,player:o,alliance:i}}function k(t){const e=t||_(),n=e.world,o=Number(GM_getValue($(n),0)),i=e.alliance||GM_getValue(V(n),"\u2014"),r=`
        <div><b>Mundo:</b> ${n||"\u2014"}</div>
        <div><b>Jogador:</b> ${e.player||"\u2014"}</div>
        <div><b>Alian\xE7a:</b> ${i}</div>
        <div><b>\xDAltimo envio:</b> ${o?Math.floor(F(o)/6e4)+" min atr\xE1s":"\u2014"}</div>
      `,s=document.querySelector("#gp-env");s&&(s.innerHTML=r)}async function ht(){const t=_();if(t.alliance)return k(t),t;const e=GM_getValue(V(t.world),"");if(e)return t.alliance=e,k(t),t;await z();const n=document.querySelector("li.alliance.main_menu_item");if(n){const o=n.querySelector(".button")||n;o&&(typeof o.click=="function"?o.click():x(o,"click")),await T(250);const i=document.querySelector("#alliance-properties");i&&(typeof i.click=="function"?i.click():x(i,"click"));const r=await bt(7e3);r&&(t.alliance=r,GM_setValue(V(t.world),r),k(t)),vt(".settings_column")}return t}async function bt(t=7e3){const e=Date.now();for(;Date.now()-e<t;){const n=document.querySelectorAll(".settings_column fieldset");for(const o of n){const i=o.querySelector("legend b");if(i&&i.textContent.trim().toLowerCase()==="nome"){const s=o.querySelector("p")?.textContent?.trim();if(s)return s}}await T(200)}return""}function vt(t){const e=document.querySelector(t);if(!e)return!1;let n=e;for(;n&&n!==document.body;){if(n.classList&&n.classList.contains("ui-dialog")){const o=n.querySelector("button.ui-dialog-titlebar-close");if(o)return typeof o.click=="function"?o.click():x(o,"click"),!0;break}n=n.parentNode}return Z()}function Z(){const t=Array.from(document.querySelectorAll("button.ui-dialog-titlebar-close"));for(let e=t.length-1;e>=0;e--){const n=t[e],o=getComputedStyle(n);if(n.offsetParent!==null&&o.display!=="none"&&o.visibility!=="hidden")return typeof n.click=="function"?n.click():x(n,"click"),!0}return!1}async function tt(){u("Checando atualiza\xE7\xE3o\u2026");const t=await wt(I),e=await it(t);let n=null;try{n=JSON.parse(e)}catch{n={endpoint:(e||"").trim(),version:null}}const o=n.endpoint,i=n.version||null,r=n.notes||null;if(!o||!/^https?:\/\/.+\/exec/.test(o))throw new Error("Gist sem endpoint v\xE1lido (/exec).");R=o,y=i,W=r,GM_setValue(pt,R);const s=GM_getValue(G,null),c=!!(i&&s&&i!==s);et(c,i,r),u("Endpoint OK."+(c?" (nova vers\xE3o dispon\xEDvel)":""))}function et(t,e,n){if(!h)return;d||(d=document.createElement("div"),Object.assign(d.style,{position:"fixed",zIndex:1e6,background:"#ef4444",color:"#fff",borderRadius:"10px",padding:"2px 6px",fontSize:"10px",fontWeight:"700",display:"none",boxShadow:"0 4px 10px rgba(0,0,0,0.35)",cursor:"pointer",userSelect:"none"}),d.textContent="UPDATE",d.title="Nova vers\xE3o dispon\xEDvel \u2014 clique para recarregar",d.onclick=()=>{location.reload()},document.body.appendChild(d)),d.style.display=t?"block":"none",ot();const o=document.querySelector("#gp-update-btn");if(o&&o.remove(),l){const i=document.createElement("button");i.id="gp-update-btn",i.textContent=t?"Atualiza\xE7\xE3o dispon\xEDvel \u2014 Recarregar":"Vers\xE3o atual",Object.assign(i.style,{width:"100%",padding:"8px",border:"0",borderRadius:"8px",background:t?"#ef4444":"#374151",color:"#fff",fontWeight:700,cursor:t?"pointer":"default",marginTop:"8px"}),i.title=n?String(n):t?"Clique para atualizar":"Voc\xEA j\xE1 est\xE1 na \xFAltima vers\xE3o",i.disabled=!t,i.onclick=()=>{t&&location.reload()},(l.querySelector('div[style*="padding:10px"]')||l).appendChild(i)}nt()}function nt(){const t=document.querySelector("#gp-ver");t&&(y?(t.textContent=`v${y}`,t.style.display="inline-block"):t.style.display="none")}function ot(){if(!h||!d)return;const t=parseInt(h.style.right||U.right,10),e=parseInt(h.style.bottom||U.bottom,10);d.style.right=t+34+"px",d.style.bottom=e+34+"px"}function wt(t){if(/gist\.githubusercontent\.com|raw\.githubusercontent\.com/.test(t))return Promise.resolve(t);const e=t.match(/gist\.github\.com\/([^/]+)\/([a-f0-9]+)/i);return e?Promise.resolve(`https://gist.githubusercontent.com/${e[1]}/${e[2]}/raw`):it(t).then(n=>{const o=n.match(/href="(https:\/\/gist\.githubusercontent\.com\/[^"]+\/raw[^"]*)"/i);if(o)return o[1];throw new Error("N\xE3o consegui resolver a URL RAW do Gist.")})}function it(t){return new Promise((e,n)=>{GM_xmlhttpRequest({method:"GET",url:t,headers:{Accept:"*/*"},onload:o=>o.status>=200&&o.status<300?e(o.responseText):n(new Error("HTTP "+o.status)),onerror:n})})}async function xt(){const t=await ht(),e=[];return document.querySelectorAll("li.unit_town.town_item").forEach(o=>{const i=(o.id||"").replace("ov_town_",""),s=o.querySelector("[data-town-id]")?.getAttribute("data-town-id")||i||null,c=o.querySelector(".gp_town_link")?.textContent?.trim()||"",f=o.querySelector(".current_units"),{units:p,heroes:a}=_t(f);(Object.keys(p).length||Object.keys(a).length)&&e.push({id:s,name:c,units:p,heroes:a})}),{timestamp:gt(),...t,cities:e}}function _t(t){const e={},n={};return t?(t.querySelectorAll(".place_unit").forEach(o=>{const i=o.querySelector(".place_unit_white, .place_unit_black, .place_unit_hero"),r=parseInt((i?.textContent||"0").replace(/\D+/g,""),10)||0;let c=Array.from(o.classList).find(p=>p.startsWith("unit_")&&p!=="unit_icon25x25");if(!c)return;c=c.replace(/^unit_/,"");const f=!!o.querySelector(".place_unit_hero")||lt.has(c);r>0&&((f?n:e)[c]=((f?n:e)[c]||0)+r)}),{units:e,heroes:n}):{units:e,heroes:n}}function St(t,e){const n=JSON.stringify(e);return new Promise((o,i)=>{GM_xmlhttpRequest({method:"POST",url:t,headers:{"Content-Type":"application/json"},data:n,onload:r=>r.status>=200&&r.status<300?o(r.responseText):i(new Error("HTTP "+r.status)),onerror:i})})}function Et(){if(q)return;q=!0;const t=document.querySelector(".toolbar_button.premium");t&&x(t,"mouseover"),setTimeout(()=>{const e=document.querySelector('li.unit_overview a[name="unit_overview"]');e&&(N=!0,typeof e.click=="function"?e.click():x(e,"click")),setTimeout(()=>{q=!1},1200)},300)}function Tt(){return!!document.querySelector("li.unit_town.town_item .current_units")}function Mt(){N&&(Z(),N=!1)}async function Y(t){R||await tt(),E||(u("Aguardando jogo carregar\u2026"),E=await z()),Et();let e=0,n=null;for(;e<w;){e++;try{if(!Tt()){u(`(${e}/${w}) Aguardando vis\xE3o de tropas\u2026`),await T(P(e));continue}u(`(${e}/${w}) Coletando tropas\u2026`);const i=await xt();if(i.cities.length===0&&e<w){u(`(${e}/${w}) Nenhuma tropa encontrada ainda. Tentando novamente\u2026`),await T(P(e));continue}i.cities.length===0&&u("Nenhuma tropa encontrada. Enviando 0 cidades\u2026"),u(`(${e}/${w}) Enviando ${i.cities.length} cidades\u2026`),await St(R,i),y&&GM_setValue(G,y);const r=_();GM_setValue($(r.world),Date.now()),X(r.world,!0,i.cities.length),u("Enviado com sucesso!"),ft(),Mt();return}catch(i){n=i,u(`Falha (tentativa ${e}). Retentando\u2026`),await T(P(e))}}const o=_();X(o.world,!1,0,n?n.message:""),u("Falha ap\xF3s m\xFAltiplas tentativas"+(n?`: ${n.message}`:"")),yt()}function Rt(){C&&clearInterval(C),L&&clearInterval(L),D&&clearInterval(D);const t=_(),e=Number(GM_getValue($(t.world),0)),n=F(e);v=Date.now()+Math.max(0,216e5-n),L=setInterval(M,1e3),M(),C=setInterval(async()=>{if(E&&Date.now()>=v&&!g){g=!0;try{await Y("auto")}finally{g=!1,v=Date.now()+216e5,M()}}},1e3);const o=async()=>{try{await tt()}catch(i){u("Falha ao atualizar endpoint: "+i.message)}};o(),D=setInterval(o,36e5),document.addEventListener("visibilitychange",()=>{!document.hidden&&Date.now()>=v&&!g&&(g=!0,Y("visible").finally(()=>{g=!1,v=Date.now()+216e5,M()}))})}function At(){if(console.log("[Grepolis Reporter] createToggleButton chamada"),h){console.log("[Grepolis Reporter] Toggle button j\xE1 existe, retornando");return}let t=null;try{t=JSON.parse(GM_getValue("gp_toggle_pos",'{"right":12,"bottom":12}'))}catch{t={right:12,bottom:12}}(typeof t?.right!="number"||typeof t?.bottom!="number")&&(t={right:12,bottom:12});const e=document.createElement("button");e.id="gp-toggle",Object.assign(e.style,{position:"fixed",right:t.right+"px",bottom:t.bottom+"px",zIndex:"999999",width:"48px",height:"48px",borderRadius:"50%",border:"0",background:"#8a2be2",color:"#fff",cursor:"pointer",boxShadow:"0 6px 18px rgba(0,0,0,0.35)",fontSize:"20px",userSelect:"none"}),e.title="Abrir painel Grepolis",e.textContent="\u{1F432}",e.addEventListener("click",()=>{l&&l.style.display!=="none"?(l.style.display="none",e.title="Abrir painel Grepolis"):(rt(),l.style.display="block",e.title="Fechar painel Grepolis")}),document.body.appendChild(e),Gt(e),h=e,console.log("[Grepolis Reporter] Toggle button criado com sucesso")}function Gt(t){let e=!1,n=0,o=0,i=0,r=0,s=!1;const c=(a,m,b)=>Math.min(b,Math.max(m,a)),f=a=>{if(!e)return;const m=a.clientX-n,b=a.clientY-o;(Math.abs(m)>3||Math.abs(b)>3)&&(s=!0);const B=window.innerWidth-60,H=window.innerHeight-60,Lt=c(i-m,0,B),Ct=c(r-b,0,H);t.style.right=`${Lt}px`,t.style.bottom=`${Ct}px`},p=a=>{if(document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",p),!e)return;e=!1;const m=parseInt(t.style.right,10)||12,b=parseInt(t.style.bottom,10)||12;GM_setValue("gp_toggle_pos",JSON.stringify({right:m,bottom:b})),s&&(a.stopPropagation(),a.preventDefault(),s=!1)};t.addEventListener("mousedown",a=>{a.button===0&&(e=!0,s=!1,n=a.clientX,o=a.clientY,i=parseInt(t.style.right,10)||12,r=parseInt(t.style.bottom,10)||12,document.addEventListener("mousemove",f),document.addEventListener("mouseup",p),a.preventDefault())})}function Ot(t){if(!dragging)return;const e=t.clientX-startX,n=t.clientY-startY;let o=O(startRight-e,0,window.innerWidth-60),i=O(startBottom-n,0,window.innerHeight-60);btn.style.right=`${o}px`,btn.style.bottom=`${i}px`,ot()}function kt(t){document.removeEventListener("mousemove",Ot),document.removeEventListener("mouseup",kt),dragging&&(dragging=!1,commit(),(Math.abs(t.clientX-startX)>5||Math.abs(t.clientY-startY)>5)&&t.stopPropagation())}function rt(){if(l)return;l=document.createElement("div"),l.id="gp-ally-panel";const t=mt(j,st);Object.assign(l.style,{position:"fixed",right:`${t.right}px`,bottom:`${t.bottom}px`,zIndex:999998,background:"rgba(20,22,28,0.97)",color:"#e5e7eb",padding:"0",border:"1px solid #2a2f3a",borderRadius:"14px",width:"360px",fontFamily:"system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif",boxShadow:"0 10px 28px rgba(0,0,0,0.45)",backdropFilter:"blur(2px)"}),l.innerHTML=`
          <div id="gp-header" style="
            position:relative; display:flex; align-items:center; gap:10px;
            padding:12px 44px 12px 14px; border-bottom:1px solid #2a2f3a;
            border-top-left-radius:14px; border-top-right-radius:14px; background:#141820; cursor:move;">
            <div style="display:flex;align-items:center;gap:10px;">
              <span style="font-size:18px;line-height:1">\u{1F432}</span>
              <div style="display:flex;flex-direction:column;gap:2px;">
                <strong style="font-size:14px;color:#fff;letter-spacing:.2px">Tropas da Alian\xE7a</strong>
                <div style="display:flex;align-items:center;gap:8px;">
                  <span id="gp-ver" style="
                    display:none; padding:2px 8px; border-radius:999px;
                    font-size:10px; font-weight:700; background:#1f2937; color:#9ca3af;">v\u2014</span>
                  <span style="font-size:11px;color:#9ca3af;">Snapshot a cada 6h</span>
                </div>
              </div>
            </div>
      
            <button id="gp-hide" title="Recolher" aria-label="Recolher painel" style="
              position:absolute; top:8px; right:8px;
              width:28px; height:28px; border:none; border-radius:8px;
              background:#1f2430; color:#cbd5e1; cursor:pointer; display:grid; place-items:center;">
              <span style="font-size:16px; line-height:1">\xD7</span>
            </button>
          </div>
      
          <div style="padding:12px 14px 14px;">
            <div id="gp-env" style="font-size:12px;opacity:.95;margin-bottom:8px;display:grid;grid-template-columns:1fr 1fr;gap:6px;"></div>
      
            <div style="display:flex;align-items:center;justify-content:space-between;margin:6px 0 10px;font-size:12px;">
              <span style="opacity:.9">Pr\xF3xima coleta:</span>
              <span id="gp-countdown" style="font-weight:800;color:#f8fafc;background:#0f172a;padding:4px 8px;border-radius:8px;min-width:86px;text-align:center">--:--:--</span>
            </div>
      
            <div style="margin:8px 0 12px;">
              <button id="gp-send-now" style="
                width:100%;padding:10px 12px;border:0;border-radius:10px;
                background:#10b981;color:#06281f;font-weight:800;cursor:pointer;letter-spacing:.2px;box-shadow:0 6px 14px rgba(16,185,129,.25);">
                Enviar agora
              </button>
            </div>
      
            <div id="gp-status" style="font-size:12px;min-height:16px;opacity:.95;margin-bottom:10px;"></div>
      
            <details id="gp-history-box" style="background:#0f1117;border:1px solid #2a2f3a;border-radius:10px;padding:8px;">
              <summary style="cursor:pointer;color:#e5e7eb;user-select:none;">Hist\xF3rico (\xFAltimos 5 envios)</summary>
              <div id="gp-history" style="margin-top:6px;font-size:12px;display:flex;flex-direction:column;gap:4px;"></div>
            </details>
      
            <div style="font-size:11px;opacity:.8;margin-top:10px;line-height:1.35;">
              D\xFAvidas, sugest\xF5es? Chama um l\xEDder.
            </div>
          </div>
        `,document.body.appendChild(l),k();try{K(JSON.parse(GM_getValue(J(_().world),"[]")))}catch{}It(l,l.querySelector("#gp-header"),j),l.querySelector("#gp-hide").onclick=o=>{o.stopPropagation(),l.style.display="none",h&&(h.title="Abrir painel Grepolis")};const e=l.querySelector("#gp-send-now"),n=()=>{const o=A-Date.now();if(g)e.disabled=!0,e.textContent="Enviando\u2026";else if(o>0){e.disabled=!0;const i=Math.ceil(o/1e3);e.textContent=`Aguarde ${i}s`}else e.disabled=!1,e.textContent="Enviar agora"};e.onclick=async()=>{if(!(g||A-Date.now()>0)){g=!0,A=Date.now()+dt,n(),u("Envio manual iniciado\u2026");try{await Y("manual")}finally{g=!1,v=Date.now()+216e5,M();const i=setInterval(()=>{n(),Date.now()>=A&&(clearInterval(i),n())},250)}}},setInterval(n,500),n(),nt()}function It(t,e,n){let o=!1,i=0,r=0,s=0,c=0;e.addEventListener("mousedown",a=>{o=!0,i=a.clientX,r=a.clientY;const m=t.getBoundingClientRect();s=parseInt(t.style.right,10)||window.innerWidth-m.right,c=parseInt(t.style.bottom,10)||window.innerHeight-m.bottom,document.addEventListener("mousemove",f),document.addEventListener("mouseup",p),a.preventDefault()});function f(a){if(!o)return;const m=a.clientX-i,b=a.clientY-r;let B=O(s-m,0,window.innerWidth-60),H=O(c-b,0,window.innerHeight-60);t.style.right=`${B}px`,t.style.bottom=`${H}px`}function p(){if(o=!1,document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",p),n){const a={right:parseInt(t.style.right,10)||0,bottom:parseInt(t.style.bottom,10)||0};GM_setValue(n,JSON.stringify(a))}}}async function at(){console.log("[Grepolis Reporter] Iniciando script...");try{if(console.log("[Grepolis Reporter] Criando toggle button..."),At(),console.log("[Grepolis Reporter] Criando painel..."),rt(),console.log("[Grepolis Reporter] Aguardando jogo ficar pronto..."),E=await z(),u(E?"Jogo pronto.":"N\xE3o detectei o menu principal, mas vou tentar continuar."),console.log("[Grepolis Reporter] Agendando execu\xE7\xE3o autom\xE1tica..."),Rt(),y){const t=GM_getValue(G,null)&&GM_getValue(G)!==y;et(t,y,W)}console.log("[Grepolis Reporter] Script inicializado com sucesso!")}catch(t){console.error("[Grepolis Reporter] Erro durante inicializa\xE7\xE3o:",t),u("Erro durante inicializa\xE7\xE3o: "+t.message)}}console.log("[Grepolis Reporter] Script carregado, readyState:",document.readyState),document.readyState==="complete"||document.readyState==="interactive"?(console.log("[Grepolis Reporter] DOM pronto, executando init()"),at()):(console.log("[Grepolis Reporter] Aguardando DOMContentLoaded..."),document.addEventListener("DOMContentLoaded",()=>{console.log("[Grepolis Reporter] DOMContentLoaded disparado, executando init()"),at()}))})()});qt();})();
